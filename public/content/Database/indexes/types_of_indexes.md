# Типы индексов в реляционных БД

## Описание
Этот файл содержит описание различных типов индексов, используемых в реляционных базах данных, таких как B-деревья, хэш-индексы, кластерные и некластерные индексы, уникальные индексы и первичные ключи.

**Плюсы:**
- Ускоряют чтение

**Минусы:**
- Замедляют запись
- Используют дополнительную память
- Усложняют работу планировщика запросов

## Вопросы и ответы

### Какие бывают типы индексов в реляционных БД?
- B-дерево (B-tree)

![Screenshot of the structure of the system elements](content/Database/indexes/btree.png)

- Хэш-индекс
- Кластерный индекс (Clustered)
- Некластерный индекс (Non-clustered)
- Уникальный индекс (Unique index)
- Полнотекстовый индекс (Full-text)
- bitmap (фильтр параметров)
- Gin index

![Screenshot of the structure of the system elements](content/Database/indexes/bitmap.png)

- Пространственный индекс (Spatial)

![Screenshot of the structure of the system elements](content/Database/indexes/spetial.png)



**Пример создания индекса:**
```sql
CREATE INDEX idx_users_email ON users(email);
```
### Чем отличается B-дерево от хэш-индекса?
- B-дерево поддерживает упорядоченные диапазонные запросы (`<`, `>`, `BETWEEN`), хэш — нет.
- Хэш-индекс быстрее для точных запросов (`=`), но неэффективен при диапазонных.

### В каких случаях B-дерево предпочтительнее, а в каких — хэш-индекс?
- B-дерево: диапазонные запросы, сортировка, выборка по диапазону времени/ID.
- Хэш: точечные выборки с фиксированным значением ключа.

### Что происходит с B-Tree, когда добавляется новая запись?

Когда добавляется новая запись:
- Идём от корня вниз, чтобы найти нужный лист.
- Вставляем ключ в листовой узел.
- Если лист переполнен — он разбивается на два, и среднее значение поднимается вверх.
- Так может дойти до разделения корня — тогда дерево растёт в высоту.

### Чем отличается clustered index от non-clustered index?
- Clustered index влияет на физический порядок строк в таблице.
- Non-clustered index — это отдельная структура, содержащая ссылку на строку таблицы.

**Кластерный индекс (Clustered Index)**

- **Данные таблицы хранятся отсортированными** по этому индексу.
- То есть **индекс — это и есть таблица**, просто отсортированная.
- В **PostgreSQL такого понятия нет в чистом виде**, но есть CLUSTER — разовая операция физической сортировки по индексу.


### В чем разница между unique index и primary key?
- Оба запрещают дубликаты.
- Primary key дополнительно не может содержать NULL и должен быть только один на таблицу.

### Что такое кластерные и некластерные индексы?

ctid) на строки в таблице.
- Большинство индексов в PostgreSQL — **некластерные**.

### Можно ли сделать кластерный индекс не primary key? Когда это может быть полезно?
Да. Полезно, если часто запрашиваются данные по другому столбцу, отличному от PK — например, по дате или внешнему ключу.

### Как индекс влияет на производительность SQL-запросов?
Индексы ускоряют `SELECT`, но замедляют `INSERT/UPDATE/DELETE`, так как при изменении данных индекс тоже обновляется.

###  Что такое GIN-индексы в PostgreSQL?

**GIN (Generalized Inverted Index)** — это особый тип индекса для массивов, JSONB, full-text search и др.

```sql
CREATE INDEX idx_articles_tags ON articles USING GIN(tags);
-- где tags — это массив: ['postgres', 'index', 'performance']
```
Как работает GIN:
- В обычном `B-tree` индексируется значение → `строка`.
- В GIN: **значение в массиве** → список **строк, где оно встречается**.

**То есть:**
- "postgres" → [строка 5, строка 9, строка 14]
- "index" → [строка 5, строка 12]